data(galtaon)
require(psych)
data(galton)
data(galton)
library(devtools)
library(Biobase)
library(UsingR)
install.packages(devtools)
install.packages(devtool)
install.packages("devtools")
require("biobase")
install.packages("biobase")
install.packages("Biobase")
install.packages("Biobase")
install.packages("Biobase")
require(Biobase)
library(UsingR)
install.packages("UsingR")
library(UsingR)
data("galton")
data(galtaon)
install.packages(c("devtools","UsingR"))
source("http://www.bioconductor.org/biocLite.R")
biocLite(c("Biobase"))
install.packages(c("devtools", "UsingR"))
galton_height
data(galtaon)
data(galton)
data(galton)
require(HistData)
data(galton)
galton
galton
head(galton)
ggplot(galton,aes(parent,child))+geom_point()
require(ggplot2)
ggplot(galton,aes(parent,child))+geom_point()
hist(galton$child,col="blue",breaks=100)
lmH <- lm(galton$child ~ galton$parent)
lmH
summary(lmH)
lmH
ggplot(galton,aes(parent,child))+geom_point() + geom_abline(yintercept=23.9415,slope=0.6463)
ggplot(galton,aes(parent,child))+geom_point() + geom_abline(yintercept=23.9415, slope=06463)
ggplot(galton,aes(parent,child))+geom_point() + geom_abline(intercept=23.9415, slope=06463)
ggplot(galton,aes(parent,child))+geom_point() + geom_abline(intercept=23.9415, slope=06463)
ggplot(galton,aes(parent,child))+geom_point() + geom_abline(intercept=23.9415, slope=06463,color="red")
ggplot(galton,aes(parent,child))+geom_point() + geom_abline(intercept=23.9415, slope=06463,color="red")
data("GaltonFamilies")
GaltonFamilies
GaltonFamilies
GaltonFamilies %>% mutate(adj_childhight=father+mother + ifelse(gender=="male",5,-5))
require(tidyverse)
GaltonFamilies %>% mutate(adj_childhight=father+mother + ifelse(gender=="male",5,-5))
GaltonFamilies %>% mutate(adj_childhight=(father+mother + ifelse(gender=="male",5,-5))/2)
GaltonFamilies<-GaltonFamilies %>% mutate(adj_childhight_pred=(father+mother + ifelse(gender=="male",5,-5))/2)
GaltonFamilies
GaltonFamilies<-GaltonFamilies %>% mutate(sexcode=ifelse(gender=="male",1,2))
lmh<-lm(GaltonFamilies$childHeight ~ GaltonFamilies$childHeight + GaltonFamilies$sexcode)
lmh<-lm(GaltonFamilies$childHeight ~ GaltonFamilies$father + GaltonFamilies$mother + GaltonFamilies$sexcode)
lmh
lmh<-lm(GaltonFamilies$childHeight ~ GaltonFamilies$midparentHeight + GaltonFamilies$sexcode)
lmh
plot(lmh)
summary(lmh)
lmh
lmh$model
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1])+ geom_point()+stat_smooth(methid="lm",col="red")
""
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1]+ geom_point()+stat_smooth(methid="lm",col="red")
)
)
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1]))+ geom_point()+stat_smooth(method="lm",col="red")
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1]))+ geom_point()+stat_smooth(method="lm",col="red") + theme_bw()
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1]))+ geom_point()+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child height")
summary(height)
summary(lmh)
str(lmh)
str(lmh)
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1]))+ geom_point()+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height")
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1]))+ geom_point(colour="gray69",shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height")
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1],color=gender))+ geom_point(shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height")
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1],color=lmh$gender))+ geom_point(shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height")
lmh$model
lmh$model[3]
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1],color=lmh$model[3]))+ geom_point(shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height")
lmh$model[3]
names(lmh$model)[3]
lmh$model[3]
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1],color=names(lmh$model[3])))+ geom_point(shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height")
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1],color=names(lmh$model[3])))+ geom_point(shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height") +scale_color_discrete()
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1],color=names(as.factor(lmh$model[3]))))+ geom_point(shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height")
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1],color=names(as.factor(lmh$model)[3])))+ geom_point(shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height")
str(lmh)
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1],color=names(as.factor(lmh$model)[3])))+ geom_point(shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height")
str(lmh)
ggplot(lmh$model,aes_string(x=names(lmh$model)[2],y=names(lmh$model)[1],color=names(as.factor(lmh$model)[3])))+ geom_point(shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height")
df<-lmh$model
df
head(df)
colnames(df)<-c("childheight","midparentheight","sex")
df$sex<-as.factor(df$sex)
ggplot(lmh$model,aes_(x=midparentheight,y=childheight,color=sex)) + geom_point(shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height")
ggplot(df,aes_(x=midparentheight,y=childheight,color=sex)) + geom_point(shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height")
df
head(dF)
head(df)
ggplot(df,aes(x=midparentheight,y=childheight,color=sex)) + geom_point(shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height")
df$sex<-as.factor(df$sex,labels=c("male","female"))
df$sex<-as.factor(df$sex,levels=c("male","female"))
df$sex<-as.factor(df$sex,level=c("male","female"))
df
level(df$sex)
levels(df$sex)
df$sex<-as.factor(df$sex)
levels(df$sex)<-c("male","female")
ggplot(df,aes(x=midparentheight,y=childheight,color=sex)) + geom_point(shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight") + ylab("Child's height")
ggplot(df,aes(x=midparentheight,y=childheight,color=sex)) + geom_point(shape=21)+stat_smooth(method="lm",col="red") + theme_bw() + xlab("midpoint_parentHeight \(inch\)") + ylab("Child's height \(inch\)")
summary(lmh)
